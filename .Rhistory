n=100
p0 = 0.2
x=0:n
p=dbinom(x,n,p0)
yl = "P(X=k)"
xl = "k"
color = "darkslategray1"
bp=barp(p,names.arg=x,col=color,cex.axis = 1.5,xlim=c(0,50),border="white")
curve(dnorm(x-1,n*p0,sqrt(n*p0*(1-p0))),add=T,col="red",lwd=2)
title(main=sprintf("n=%d, p=%g",n,p0),cex.main=1.5,font.main=1,xlab="k",ylab="P(X=k)",cex.lab=1.5)
n=100
p0 = 0.2
x=0:n
p=dbinom(x,n,p0)
yl = "P(X=k)"
xl = "k"
color = "darkslategray1"
bp=barp(p,names.arg=x,col=color,cex.axis = 1.5,xlim=c(0,50),border="white")
curve(dnorm(x-1,n*p0,sqrt(n*p0*(1-p0))),add=T,col="red",lwd=2)
title(main=sprintf("n=%d, p=%g",n,p0),cex.main=1.5,font.main=1,xlab="k",ylab="P(X=k)",cex.lab=1.5)
library(plotrix)
n=100
p0 = 0.2
x=0:n
p=dbinom(x,n,p0)
yl = "P(X=k)"
xl = "k"
color = "darkslategray1"
bp=barp(p,names.arg=x,col=color,cex.axis = 1.5,xlim=c(0,50),border="white")
curve(dnorm(x-1,n*p0,sqrt(n*p0*(1-p0))),add=T,col="red",lwd=2)
title(main=sprintf("n=%d, p=%g",n,p0),cex.main=1.5,font.main=1,xlab="k",ylab="P(X=k)",cex.lab=1.5)
pwd()
pwd
getwd()
data = read.table("Experiment.csv")
data = read.table("Experiment.csv")
data
?read.table
data = read.table("Experiment.csv",header=T,sep=",")
data
shape(data)
data.dim
dim(data)
data = read.table("Experiment.csv",header=T,sep=",",as.is = F)
data
summary(data)
stringsAsFactors
data = read.table("Experiment.csv",header=T,sep=",",as.is = T)
data
data = read.table("Experiment.csv",header=T,sep=",",stringsAsFactors = T)
data
data = read.table("Experiment.csv",header=T,sep=",",encoding="UTF-8")
data
data = read.table("Experiment.csv",header=T,sep=",",encoding="latin1")
data
data = read.table("Experiment.csv",header=T,sep=",",encoding="UTF-8")
data
data = read.table("Experiment.csv",header=T,sep=",",encoding="UTF-32")
data
data = read.table("Experiment.csv",header=T,sep=",",encoding="UTF-16")
data
data = read.table("Experiment.csv",header=T,sep=",",encoding="UTF-8")
data
data = read.table("Experiment.csv",header=T,sep=",col.names=1:21)
)
data = read.table("Experiment.csv",header=T,sep=",",col.names=1:21)
data
class(x2)
class(X2)
class(data$X2)
as.numeric(data)
as.numeric(data[,2:21])
data[,2:21]
data = read.table("Experiment.csv",header=T,sep=",",col.names=1:21)[2:21]
data
data$X1
data$X2
data$X3
data$X4
data$X5
as.numeric(data$X5)
as.numeric(data[,1])
as.numeric(data[,2])
as.numeric(data)
as.numeric(data[,1:2])
as.numeric(data[,2])
as.numeric(data[1,])
as.numeric(data[2,])
n = dim(data)[1]
n
as.numeric(data[,2])
x = as.numeric(data[,2])
sum(x==1)
num_exps = 20
data = read.table("Experiment.csv",header=T,sep=",")
n = dim(data)[1]
num_heads = numeric(num_exps)
for (i in 1:num_exps)
{
x = as.numeric(data[,i+1])
num_heads[i] = sum(x==1)
}
num_heads
n-num_heads
mean(num_heads)
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
num_heads
table(num_heads)
hist(num_heads,breaks=0:4)
hist(num_heads,breaks=0:5)
?table
?hist
hist(num_heads,0:4,include.lowest = F)
hist(num_heads,0:4,include.lowest = F)$counts
hist(num_heads,0:4,include.lowest = F,right=F)$counts
hist(num_heads,0:4,include.lowest = F,right=T)$counts
hist(num_heads,0:4,include.lowest = T,right=T)$counts
emp_p = numeric(n+1)
for (i in 0:n)
{
emp_p = sum(num_heads==i)
}
emp-p
emp_p
emp_p = numeric(n+1)
for (i in 0:n)
{
emp_p[i] = sum(num_heads==i)
}
emp_p
emp_p = numeric(n+1)
for (i in 0:n)
{
emp_p[i+1] = sum(num_heads==i)
}
emp_p
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
?barp
emp_p
p
c(emp_p,p)
t(p)
?paste
cbind(p,emp_p)
bp=barp(cbind(p,emp_p),names.arg=x,col=color,cex.axis = 1.5,xlim=c(0,n+2),ylim=c(0,max(p)*1.25),border="white")
rbind(p,emp_p)
bp=barp(rbind(p,emp_p),names.arg=x,col=color,cex.axis = 1.5,xlim=c(0,n+2),ylim=c(0,max(p)*1.25),border="white")
?barp
bp=barp(rbind(p,emp_p),names.arg=x,col=color,cex.axis = 1.5,xlim=c(0,n+2),ylim=c(0,max(p)*1.25),border="darkgray",legend.lab = c("Expected","Observed"))
bp=barp(cbind(p,emp_p),names.arg=x,col=color,cex.axis = 1.5,xlim=c(0,n+2),ylim=c(0,max(p)*1.25),border="darkgray",legend.lab = c("Expected","Observed"))
bp=barp(cbind(p,emp_p),names.arg=x,col=color,cex.axis = 1.5,xlim=c(0,n+2),ylim=c(0,max(p)*1.25),border="darkgray")
# dev.off()
#names.arg=x,
bp=barp(cbind(p,emp_p),col=color,cex.axis = 1.5,xlim=c(0,n+2),ylim=c(0,max(p)*1.25),border="darkgray",legend.lab = c("Expected","Observed"))
bp=barp(cbind(p,emp_p))
bp=barp(rbind(p,emp_p))
x
bp=barp(rbind(p,emp_p),names.arg=x)
bp=barp(rbind(p,emp_p),names.arg=x,col=color)
bp=barp(rbind(p,emp_p),names.arg=x,col=c(mediumpurple4,lightsalmon4),cex.axis = 1.5,xlim=c(0,n+2),ylim=c(0,max(p)*1.25),border="darkgray",legend.lab = c("Expected","Observed"))
bp=barp(rbind(p,emp_p),names.arg=x,col=c("mediumpurple4","lightsalmon4"),cex.axis = 1.5,xlim=c(0,n+2),ylim=c(0,max(p)*1.25),border="darkgray",legend.lab = c("Expected","Observed"))
bp=barp(rbind(p,emp_p),names.arg=x,col=c("mediumpurple4","lightsalmon4"),cex.axis = 1.5,xlim=c(0,n+2),ylim=c(0,max(p)*1.25),border="darkgray",legend.lab = c("Expected","Observed"),legend.pos = c(0,0.4))
bp=barp(rbind(p,emp_p),names.arg=x,col=c("mediumpurple4","lightsalmon4"),cex.axis = 1.5,xlim=c(0,n+2),ylim=c(0,max(p)*1.25),border="darkgray",legend.lab = c("Expected","Observed"),legend.pos = c(0,0.5))
bp=barp(rbind(p,emp_p),names.arg=x,col=c("mediumpurple4","lightsalmon4"),cex.axis = 1.5,xlim=c(0,n+2),ylim=c(0,max(p)*1.3),border="darkgray",legend.lab = c("Expected","Observed"),legend.pos = c(0,0.5))
bp=barp(rbind(p,emp_p),names.arg=x,col=c("mediumpurple","lightsalmon3"),cex.axis = 1.5,xlim=c(0,n+2),ylim=c(0,max(p)*1.3),border="darkgray",legend.lab = c("Expected","Observed"),legend.pos = c(0,0.5))
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
n = 20
data = read.table("Experiment.csv",header=T,sep=",")
num_exps = dim(data)[2]
num_exps
num_exps = dim(data)[1]
num_exps
data[1,]
as.numeric(data[i,])
i
i=1
as.numeric(data[i,])
as.numeric(data[2,])
as.numeric(data[3,])
as.numeric(data[4,])
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
as.numeric(data[i,2:(n+1)])
n
length(as.numeric(data[i,2:(n+1)]))
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
p
emp_p
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
dbinom(10,20,0,5)
dbinom(10,20,0.5)
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
?barp
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
mean(num_heads)
sd(num_heads)
20/4
var(num_heads)
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
.8^2/2
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
num_exps
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
num_heads
num_heads = num_heads[c(1:5,11:length(num_heads))]
num_heads
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
source('D:/Work/Teaching/StatisticsBasic/RCode/BinomialExperiment.R')
0.36^3
3/5*2/4*1/3
500e3/1e6 * (500e3-1)/(1e6-1) * (500e3-2)/(1e6-2)
dbinom(2,3,0.6)
dbinom(2,3,0.5)
(500e3/1e6) * (500e3-1)/(1e6-1) * (500e3)/(1e6-2)
(500e3/1e6) * (500e3-1)/(1e6-1) * (500e3)/(1e6-2) * 3
setwd("D:/Work/Projects/Prediction/Disease/Code/embryo_selection")
source('D:/Work/Projects/Prediction/Disease/Code/embryo_selection/EmbryoSelectionAnalysis_Lowest.R')
risk_reduction_lowest_family_history_long(0.1,0.5,0.02,5,T,F)
risk_reduction_lowest_family_history(0.1,0.5,0.02,5,T,F)
risk_reduction_exclude_family_history(0.1,0.5,0.02,0.05,5,T,F)
source('D:/Work/Projects/Prediction/Disease/Code/embryo_selection/EmbryoSelectionAnalysis_Exclude.R')
risk_reduction_exclude_family_history(0.1,0.5,0.02,0.05,5,T,F)
source('D:/Work/Projects/Prediction/Disease/Code/embryo_selection/EmbryoSelectionAnalysis_Exclude.R')
risk_reduction_exclude_family_history(0.1,0.5,0.02,0.05,5,T,F)
2/sqrt(5)
2/sqrt(50)
2/sqrt(500)
10*0.8*0.2
sqrt(10*0.8*0.2)/sqrt(50)
sqrt(10*0.8*0.2)/sqrt(1)
x = c(10,5,8,16)
mean(x)
39/4
(x-mean(x))^2/4
sum((x-mean(x))^2)/4
var(x)
var(x)*4/3
var(x)*3/4
x
rep(x,4)
matrix(rep(x,4),4,4
)
matrix(rep(x,4),4,4)
t(x)
t(matrix(rep(x,4),4,4))
m1 = matrix(rep(x,4),4,4)
m2 = t(matrix(rep(x,4),4,4))
(m1+m2)/2
numeric((m1+m2)/2)
as.vector((m1+m2)/2)
par(mar=c(4.5,4.9,1.5,0.4))
x = c(10,5,8,16)
m1 = matrix(rep(x,4),4,4)
m2 = t(matrix(rep(x,4),4,4))
y = as.vector((m1+m2)/2)
hist(y,breaks = 6,col="lightblue",cex.axis = 2,cex.lab=2.5,xlim=c(0,10),main="", xlab="",xaxt="n")
x = c(10,5,8,16)
m1 = matrix(rep(x,4),4,4)
m2 = t(matrix(rep(x,4),4,4))
y = as.vector((m1+m2)/2)
hist(y,breaks = 6,col="lightblue",cex.axis = 2,cex.lab=2.5,main="", xlab="Sample average")
5+2*6.5+2*7.5+8+2*9+10+2*10.5+2*12+2*13+16
(5+2*6.5+2*7.5+8+2*9+10+2*10.5+2*12+2*13+16)/16
x = c(5,6.5,7.5,8,9,10,10.5,12,13,16)
x
p = c(1,2,2,1,2,1,2,2,2,1)/16
p*x
sum(p*x)
sum(p*(x-9.75)^2)
sum(p*(x-9.75)^2)*2
?combn
combn(c(10,5,8,16),3)
combn(4,3)
library(gtools)
?combinations
x = c(10,5,8,16)
combinations(4,3,x)
combinations(4,3,x,repeats.allowed = T)
combinations(4,3,x,set=F,repeats.allowed = T)
n = length(x)
1:n^3
m = 3
tot = n^m
tot
seq = 1:64
seq %% 4
seq/1 %% 4
seq/1 %% 4 +1
(seq/1) %% 4 +1
((seq/1)-1) %% 4 +1
((seq/4)-1) %% 4 +1
((seq/4)-1)
((seq/4))
(ceiling(seq/4))
((ceiling(seq/4))-1) %% 4 +1
((ceiling(seq/4))-1) %% 4 + 1
((ceiling(seq/16))-1) %% 4 + 1
x = c(10,5,8,16)
n = length(x)
m = 3
tot = n^m
avg = numeric(tot)
for (i in 1:tot)
{
sample = numeric(m)
for (j in 1:m)
{
sample[j] = (ceiling(seq/(4^(j-1)))-1) %% 4 + 1
}
}
avg
sample
for (i in 1:tot)
{
sample = numeric(m)
for (j in 1:m)
{
sample[j] = (ceiling(i/(4^(j-1)))-1) %% 4 + 1
}
}
sample
avg = numeric(tot)
for (i in 1:tot)
{
sample = numeric(m)
avg[i] = 0
for (j in 1:m)
{
sample[j] = (ceiling(i/(4^(j-1)))-1) %% 4 + 1
avg[i] = avg[i] + sample[j]
}
avg[i] = avg[i]/m
}
avg
avg = numeric(tot)
for (i in 1:tot)
{
sample = numeric(m)
avg[i] = 0
for (j in 1:m)
{
sample[j] = (ceiling(i/(4^(j-1)))-1) %% 4 + 1
avg[i] = avg[i] + x[sample[j]]
}
avg[i] = avg[i]/m
}
avg
avg = numeric(tot)
for (i in 1:tot)
{
sample = numeric(m)
avg[i] = 0
for (j in 1:m)
{
sample[j] = (ceiling(i/(4^(j-1)))-1) %% 4 + 1
avg[i] = avg[i] + x[sample[j]]
}
sample
avg[i] = avg[i]/m
}
cat(sample)
avg = numeric(tot)
for (i in 1:tot)
{
sample = numeric(m)
avg[i] = 0
for (j in 1:m)
{
sample[j] = (ceiling(i/(4^(j-1)))-1) %% 4 + 1
avg[i] = avg[i] + x[sample[j]]
}
cat(sample)
avg[i] = avg[i]/m
}
library(gtools)
x = c(10,5,8,16)
n = length(x)
m = 3
tot = n^m
avg = numeric(tot)
for (i in 1:tot)
{
sample = numeric(m)
avg[i] = 0
for (j in 1:m)
{
sample[j] = (ceiling(i/(4^(j-1)))-1) %% 4 + 1
avg[i] = avg[i] + x[sample[j]]
}
cat(sample)
cat()
avg[i] = avg[i]/m
}
avg = numeric(tot)
for (i in 1:tot)
{
sample = numeric(m)
avg[i] = 0
for (j in 1:m)
{
sample[j] = (ceiling(i/(4^(j-1)))-1) %% 4 + 1
avg[i] = avg[i] + x[sample[j]]
}
cat(sample)
cat("\n")
avg[i] = avg[i]/m
}
avg
hist(avg)
table(avg)
avg = round(avg*100)/100
avg
table(avg)
(5+8+16)/3
(8+10+16)/3
(8+10+16)/3
(5+8+10)/3
(5+10+16)/3
(8+8+10)/3
(5+5+16)/3
summary(table(avg))
as.numeric(table(avg))
names(table(avg))
as.numeric(names(table(avg)))
p = as.numeric(table(avg))/64
p
y = as.numeric(names(table(avg)))
y
mean(y*p)
p
p
y
sum(y*p)
sum((y-9.75)^2*p)
sum((y-9.75)^2*p)/4
sum((y-9.75)^2*p)/4 * 3
sum((y-9.75)^2*p)
sum((y-9.75)^2*p)  *3
y
sum(p[1:14])
51/64
26/64
38/64
1-26/64
19/32
sum((y-9.75)^2*p)
sum((y-9.75)^2*p)*3
par(mar=c(4.5,4.9,1.5,0.4))
hist(avg,breaks = 6,col="lightblue",cex.axis = 2,cex.lab=2.5,main="", xlab="Sample average")
par(mar=c(4.5,4.9,1.5,0.4))
hist(avg,breaks = 10,col="lightblue",cex.axis = 2,cex.lab=2.5,main="", xlab="Sample average")
par(mar=c(4.5,4.9,1.5,0.4))
hist(avg,breaks = 6,col="lightblue",cex.axis = 2,cex.lab=2.5,main="", xlab="Sample average")
?dec2base
pnorm(2/3,lower.tail = F)
12/sqrt(16)
pnorm(-1)
pnorm(1/3)
pnorm(1/3)-pnorm(-1/3)
12/8
2/1.5
pnorm(4/3,lower.tail = F)
pnorm(2)
pnorm(1)
1/1.5
pnorm(2/3)-pnorm(-2/3)
4*0.5*0.5
5/sqrt(100)
pnorm(2)
pnorm(1)
pnorm(-0.4)-pnorm(-1.6)
0.2/0.5
0.8/0.5
58+1.96*12/sqrt(16)
58-1.96*12/sqrt(16)
61-1.96*12/sqrt(64)
61+1.96*12/sqrt(64)
24-1.96*8/sqrt(100)
24+1.96*8/sqrt(100)
21+1.96*8/sqrt(400)
21-1.96*8/sqrt(400)
qnorm(0.1)
qnorm(0.9)
58+1.28*12/sqrt(16)
58-1.28*12/sqrt(16)
61-1.64*12/sqrt(64)
61+1.64*12/sqrt(64)
qnorm(0.99)
qnorm(0.995)
60+2.58*12/sqrt(256)
60-2.58*12/sqrt(256)
1.28*12/sqrt(16)
1.64*12/sqrt(64)
2.58*12/sqrt(256)
3.92*8/3
(3.92*8/3)^2
(2.58*2*8/3)^2
