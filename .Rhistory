1-(1-p)^5
p = pnorm((85-qnorm(0.95)*2-83)/2)
p
1-(1-p)^5
p = pnorm((85-qnorm(0.9)*2-83)/2)
p
p = pnorm((85-qnorm(0.99)*2-83)/2)
p
1-(1-p)^5
0.84*49
3.9^2
94*0.79+7
160e3/20e6
1/16*2
c(0, 0.425, 0.057, 0.151)
c(0, 0.425, 0.057, 0.151)*2
0.85/2+0.057/4+0.151/8
0.85/2+0.057/4+0.151/4
0.85/2+0.057+0.151
70-2*qnorm(0.95)
70-2*qnorm(0.95)-67
(70-2*qnorm(0.95)-67)/2
pnorm((70-2*qnorm(0.95)-67)/2)
pnorm((70-2*qnorm(0.95)-67)/2,lower.tail = F)
pbinom(6,9,0.5)
pbinom(6,9,0.5,lower.tail = F)
pbinom(8,9,0.5,lower.tail = F)
pbinom(7,9,0.5,lower.tail = F)
pbinom(9,9,0.5,lower.tail = F)
pbinom(0,9,0.5,lower.tail = F)
9/256
pbinom(7,9,0.5,lower.tail = F)
pbinom(6,9,0.5,lower.tail = F)
23/256
-5/6
pnorm(-5/6,lower.tail = F)
pbinom(0,9,0.5)
pbinom(1,9,0.5)
pbinom(1,9,0.5)*2
pbinom(7,9,0.80,lower.tail = F)
pbinom(7,9,pnorm(-5/6,lower.tail = F),lower.tail = F)
3*4*7
65/26
65/256
pbinom(5,9,0.5,lower.tail = F)
pbinom(7,9,pnorm(-5/6,lower.tail = F))
1-9*0.8^8*0.2-0.8^9
pnorm(0.5,lower.tail = F)
pbinom(9,9,0.5,lower.tail = F)
pbinom(8,9,0.5,lower.tail = F)
1-0.31^9
1-0.65^9
pnorm(-0.5,lower.tail = F)
1-0.69^9
0.69^9
pnorm(-0.5,lower.tail = F)
pnorm(-0.5,lower.tail = F)^9
1-0ץ91^5
1-0.91^5
32+12+34+30+30
1/16
pbinom(5,7,0.5,lower.tail = )
pbinom(5,7,0.5,lower.tail = F)
1/512
4.5*15
(31-40.3)
9.8^2*2/70
sqrt(2.744)
38-40.3
(38-40.3)/sqrt(2.744)
pnorm((38-40.3)/sqrt(2.744))
8^2/50+1/7+7^2/13
2*(8^2/50+1/7+7^2/13)
(5*60)/(10*65)
-0.5*log(1-r^2)
r = 0.3
r^2
-0.5*log(1-r^2)
20/-0.5*log(1-r^2)
20/(-0.5*log(1-r^2))
log2(500e3)
19/(-0.5*log(1-0.1))
2400/0.4
55.44/22
55.44/32.5
60.11/40.4
60.11/(40.4*7)
55.44/(32.5*7)
60.11/49
0.2125*40.4/7
30-32*60.11/49
30-32*1.23
a = 55.44/49
a
55.44/(7*32.5)
55.44/(7*32.5) * 32.5/7
100-a*32
30-32*60.11/49
b=30-32*60.11/49
a = 60.11/49
a
b
a*30+b
1.23*30-9.26
1-0.21^2
r=60.11/(7*40.4)
r
1-r^2
45-18
1.5*27
18-40.5
45+40.5
40.4^2/70
sqrt(40.4^2/70)
10/sqrt(40.4^2/70)
pnorm(10/sqrt(40.4^2/70),lower.tail = F)
0.14*0.4
1/7*0.4
1/7+0.08-1/7*0.4
0.14+0.08-0.057
30*1.6
100*0.4*0.6
10/sqrt(24)
pnorm(10/sqrt(24),lower.tail = F)
pnorm(10/sqrt(24),lower.tail = F)*2
0.4*0.3+0.35*0.8+0.35*0.55
0.4*0.3/(0.4*0.3+0.35*0.8+0.35*0.55)
0.35*0.8+0.35*0.55
0.8*0.35/(0.35*0.8+0.35*0.55)
0.8/(0.55+0.8)
275*3
choose(5,2)
choose(11,4)
choose(5,1)
choose(11,3)*5
choose(11,2)*choose(5,2)
choose(11,2)*choose(5,2)+choose(11,3)*5+choose(11,4)
choose(16,4)
5*choose(11,3)
825/1820
10/sqrt(21)
8/sqrt(21)
6/sqrt(21)
pnorm(6/sqrt(21),lower.tail = F)
3.4^2/15
sqrt(3.4^2/15)
-0.5/sqrt(3.4^2/15)
pnorm(-0.5/sqrt(3.4^2/15))
2.14*3/sqrt(15)
5+2.14*3/sqrt(15)
5-2.14*3/sqrt(15)
1-0.5925
1000*(1-0.5925)
30*1ץ1
30*1.1
14+29+8+18+14+29
30/65
2/35
1/7+0.08-2/35
10/sqrt(24)
pnorm(10/sqrt(24),loweF
pnorm(10/sqrt(24),lower.tail = F)
80/(80+55)
845/1820
825/1820
2.14*3/sqrt(15)
97*0.0662
69*0.0662
69*2*0.0662
97*0.0056
97*2*0.0056
97*2
69*2
0.05/0.0016
pnorm(10/6,lower.tail = F)
p=pnorm(10/6,lower.tail = F)
dbinom(1,20,p)
mu=200*p
mu
sigma = 200*p*(1-p)
sigma
sigma = sqrt(200*p*(1-p))
sigma
mu
pnorm(10,mu,sigma)
pnorm(15,mu,sigma)
pnorm(13,mu,sigma)
qnorm(0.25)
qnorm(0.75)
qnorm(0.75)*2
qnorm(0.75)*2*2
qnorm(0.75)*2*2*6
80+qnorm(0.75)*2*2*6
80-qnorm(0.75)*2*2*6
qnorm(0.75)*2*2
pnorm(qnorm(0.75)*2*2,lowe
r.tail=F)
pnorm(qnorm(0.75)*2*2,lower.tail = F)
pnorm(qnorm(0.75)*2*2,lower.tail = F)*2
pnorm(qnorm(0.75)*2*2,lower.tail = F)*2*200
qnorm(0.95)
qnorm(0.95)*sqrt(100*0.7*0.3)
mu = 100*.7
mu
sigma = sqrt(100*0.7*0.3)
sigma
qnorm(0.95)*sigma+mu
100*0.7*200
(200*sigma)^2
0.6*0.1/(0.6*0.1+0.2*0.4)
6000^2*(1-0.6^2)
(3.92*15/4)^2
3489.29
3489/29
3489/(sqrt(5157)*sqrt(9305))
(3489/(sqrt(5157)*sqrt(9305)))^2
r = 3489/(sqrt(5157)*sqrt(9305))
a = 3489/5157
a
73-a*76
b=73-a*76
a*85+b
sigma = 9*sqrt(1/50+1/40)
sigma
4/sigma
pnorm(4/sigma,lower.tail = F)
r = 21.8/(sqrt(44.84*3.70))
r
r = 21.8/(44.84*3.70)
t
r
r = 21.8/7/(sqrt(44.84*3.70))
r
a = 21.8/7 / 44.84
a
b = 12.64-a*95.39
b
r^2
80*170.200
80*170/200
80*30/200
120*170/200
120*30/200
10^2*(1/68+1/102+1/12+1/18)
58*8/(112*22)
pnorm(0.17,lower.tail = F)
x= c(85,80,91,76,80,82,94,72,65)
sd(x)
y= c(92,88,77,81,80,87,93,87,78)
sd(y)
var(x)*8/9
var(y)*8/9
(var(y)*8/9 + var(x)*8/9)/2
sqrt((var(y)*8/9 + var(x)*8/9)/2)
sqrt(var(x)*8/9)
sqrt(var(y)*8/9)
(sqrt(var(y)*8/9)+sqrt(var(x)*8/9))/2
0.22/((sqrt(var(y)*8/9)+sqrt(var(x)*8/9))/2*sqrt(2/9))
0.22/(7.045*sqrt(2/9))
pnorm(0.22/(7.045*sqrt(2/9)),lower.tail = F)
t = mean(x-y)/(sd(x-y)/9)
t
mean(x-y)
0.22/(7.045*sqrt(2/3))
t = mean(x-y)/(sd(x-y)/3)
t
pt(1.470539,8,lower.tail = F)
var(x-y)*8/9
sqrt(var(x-y)*8/9)
mean(x-y)*3/sqrt(var(x-y)*8/9)
0.5^8
pbinom(6,9,0.5)
pbinom(6,9,0.5,lower.tail = F)
pbinom(7,9,0.5,lower.tail = F)
pbinom(7,8,0.5,lower.tail = F)
pbinom(6,8,0.5,lower.tail = F)
pnorm(5/6)
1-9*0.79^8*0.21-0.79^9
1-9*0.81^8*0.19-0.81^9
1-9*0.8^8*0.2-0.8^9
pnorm(1.5,lower.tail = F)
73.08-75
(73.08-75)/2
pnorm((73.08-75)/2,lower.tail = F)
x
y
sd(x-y)
sqrt(var(x-y)*8/9)
pnorm(0.56/3,lower.tail = F)
pnorm(0.56/(sd(x-y)/3),lower.tail = F)
pnorm(4.22/(8*sqrt(2/9)),lower.tail = F)
pbinom(7,9,0.5,lower.tail = F)
pbinom(7,9,0.5,lower.tail = F)-dbinom(9,9,0.5)
2*1.94+70
pnorm((73.88-75)/2,lower.tail = F)
pnorm((73.28-75)/2,lower.tail = F)
pnorm((73.29-75)/2,lower.tail = F)
-2*1.94+70
pnorm((66.12-67)/2,lower.tail = F)
pnorm((66.71-67)/2,lower.tail = F)
mean(x-y)/(sd(x-y)/3)
(mean(x)-80)/(sd(x)/3)
pnorm((mean(x)-80)/(sd(x)/3),lower.tail = F)
pnorm((mean(x)-80)/(6/3),lower.tail = F)
6*sqrt(2/9)
pnorm(5/sqrt(8),lower.tail = F)
590/6
590/6*0.025
590/6*0.15
590/6*0.15+91.6*0.85
10*9/2
45/1024
dbinom(8,10,0.5)
1/dbinom(8,10,0.5)
dbinom(9,10,0.5)
dbinom(7,10,0.5)
10*9*8/6
120/1024
dbinom(8,10,0.5)
dbinom(6,10,0.5)
dbinom(13,20,0.5)
dbinom(60,100,0.5)
pbinom(59,100,0.5,lower.tail = F)
dbinom(55,100,0.5)
pbinom(54,100,0.5,lower.tail = F)
dbinom(53,100,0.5)
dbinom(54,100,0.5)
dbinom(550,1000,0.5)
pbinom(550,1000,0.5)
pbinom(550,1000,0.5,lower.tail = F)
pbinom(520,1000,0.5,lower.tail = F)
pbinom(510,1000,0.5,lower.tail = F)
dbinom(510,1000,0.5)
dbinom(600,1000,0.5)
dbinom(550,1000,0.5)
dbinom(580,1000,0.5)
pnorm(100/sqrt(250),lower.tail = F)
pnorm(100.5/sqrt(250),lower.tail = F)
pnorm(99.5/sqrt(250),lower.tail = F)
pnorm(49.5/sqrt(250),lower.tail = F)
pbinom(599,1000,0.5,lower.tail = F)
pbinom(549,1000,0.5,lower.tail = F)
dbinom(510,1000,0.5)
pbinom(509,1000,0.5,lower.tail = F)
(100+97+87+300)/6
(100+97+87+300)/6*0.15
(100+97+87+300)/6*0.15+85
pbinom(549,1000,0.5,lower.tail = F)
pbinom(529,1000,0.5,lower.tail = F)
pbinom(524,1000,0.5,lower.tail = F)
pbinom(519,1000,0.5,lower.tail = F)
pbinom(599,1000,0.5,lower.tail = F)
40.4^2/0
40.4^2/70
10/sqrt(40.4^2/70)
pnorm(10/sqrt(40.4^2/70),lower.tail = F)
(89+60+29)*0.1+75*0.9
(89+60+29)*0.1+70*0.9
((89+60+29)/3)*0.1+70*0.9
((89+60+29)/3)*0.1+75*0.9
pbinom(52,100,0.5,lower.tail = F)
pbinom(529,1000,0.5,lower.tail = F)
0.65^2
48*22/70
48*48/70
22*22/70
13-15.1
9-6.9
35-32.9
2.1^2 * (2/15.1 + 1/32.9 + 1/6.9)
pbinom(1,6,0.02)
pbinom(1,6,0.02,lower.tail = F)
pbinom(0,6,0.02,lower.tail = F)
8000*30
5000*30
0.055*9e6
x = c(4,-3,0,1,5)
y = c(7,6,4,5,2)
plot(x,y)
x = c(-4,-3,0,1,5)
plot(x,y)
y = c(7,6,4,5,3)
plot(x,y)
cov(x,y)
mean(x)
mean(y)
x-mean(x)
(x-mean(x))*(y-mean(y))
sum((x-mean(x))*(y-mean(y)))
sum((x-mean(x))*(y-mean(y)))/4
0.94^2
cor(x,y)
lm(y~x)
y = c(5,6,4,5,3)
plot(x,y)
cov(x,y)
cor(x,y)
lm(y~x)
0.2*800
0.1*800
0.05*800
0.05*800+50
0.05*600+50
0.05*500+50
setwd("D:/Work/Projects/Prediction/Code/embryo_selection")
source('D:/Work/Projects/Prediction/Code/embryo_selection/EmbryoSim_Lowest.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/EmbryoSim_Lowest.R')
par(mar=c(4.5,5,1,1))
plot(ns,risk_red_sim*100,cex=1.5,xlab="Number of embryos",ylab="Risk reduction(%)",cex.lab=1.5,cex.axis=1.25,lwd=2,main='Lowest risk',font.main=1,ylim=c(0,80))
lines(ns,risk_red_th*100,lwd=2,col='DarkSlateGray',lty=1)
legend('bottomright',c(sprintf("Prevalence=%g",K),as.expression(bquote('r'^'2'*'='*.( r2)))),bty='n',cex=1.3,text.col='darkblue')
index = 4
segments(ns[index],-10,ns[index],risk_red_sim[index]*100,col='darkgray',lty=2,lwd=2)
segments(ns[index],risk_red_sim[index]*100,-10,risk_red_sim[index]*100,col='darkgray',lty=2,lwd=2)
par(mar=c(4.5,5,1,1))
plot(ns,risk_red_sim*100,cex=1.5,xlab="Number of embryos",ylab="Risk reduction(%)",cex.lab=1.5,cex.axis=1.25,lwd=2,main='Lowest risk',font.main=1,ylim=c(0,70))
lines(ns,risk_red_th*100,lwd=2,col='DarkSlateGray',lty=1)
legend('bottomright',c(sprintf("Prevalence=%g",K),as.expression(bquote('r'^'2'*'='*.( r2)))),bty='n',cex=1.3,text.col='darkblue')
index = 4
segments(ns[index],-10,ns[index],risk_red_sim[index]*100,col='darkgray',lty=2,lwd=2)
segments(ns[index],risk_red_sim[index]*100,-10,risk_red_sim[index]*100,col='darkgray',lty=2,lwd=2)
png("../Figures/LowestRisk.png",1400,1000,res=300)
par(mar=c(4.5,5,1,1))
plot(ns,risk_red_sim*100,cex=1.5,xlab="Number of embryos",ylab="Risk reduction (%)",cex.lab=1.5,cex.axis=1.25,lwd=2,main='Lowest risk',font.main=1,ylim=c(0,70))
lines(ns,risk_red_th*100,lwd=2,col='DarkSlateGray',lty=1)
legend('bottomright',c(sprintf("Prevalence=%g",K),as.expression(bquote('r'^'2'*'='*.( r2)))),bty='n',cex=1.3,text.col='darkblue')
index = 4
segments(ns[index],-10,ns[index],risk_red_sim[index]*100,col='darkgray',lty=2,lwd=2)
segments(ns[index],risk_red_sim[index]*100,-10,risk_red_sim[index]*100,col='darkgray',lty=2,lwd=2)
dev.off()
png("../Figures/LowestRisk.png",1400,1000,res=300)
par(mar=c(4.5,5,1,1))
plot(ns,risk_red_sim*100,cex=1.5,xlab="Number of embryos",ylab="Risk reduction (%)",cex.lab=1.5,cex.axis=1.25,lwd=2,main='',font.main=1,ylim=c(0,70))
lines(ns,risk_red_th*100,lwd=2,col='DarkSlateGray',lty=1)
legend('bottomright',c(sprintf("Prevalence=%g",K),as.expression(bquote('r'^'2'*'='*.( r2)))),bty='n',cex=1.3,text.col='darkblue')
index = 4
segments(ns[index],-10,ns[index],risk_red_sim[index]*100,col='darkgray',lty=2,lwd=2)
segments(ns[index],risk_red_sim[index]*100,-10,risk_red_sim[index]*100,col='darkgray',lty=2,lwd=2)
dev.off()
png("../Figures/LowestRisk.png",1400,1000,res=300)
par(mar=c(4.5,5,1,1))
plot(ns,risk_red_sim*100,cex=1.5,xlab="Number of embryos",ylab="Risk reduction (%)",cex.lab=1.5,cex.axis=1.25,lwd=2,main='Lowest risk',font.main=1,ylim=c(0,70))
lines(ns,risk_red_th*100,lwd=2,col='DarkSlateGray',lty=1)
legend('bottomright',c(sprintf("Prevalence=%g",K),as.expression(bquote('r'^'2'*'='*.( r2)))),bty='n',cex=1.3,text.col='darkblue')
index = 5
segments(ns[index],-10,ns[index],risk_red_sim[index]*100,col='darkgray',lty=2,lwd=2)
segments(ns[index],risk_red_sim[index]*100,-10,risk_red_sim[index]*100,col='darkgray',lty=2,lwd=2)
dev.off()
rm(list=ls())
break
source('D:/Work/Projects/Prediction/Code/embryo_selection/EmbryoSim_Exclude.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/EmbryoSim_Lowest.R')
plot.new()
plot.new(xlab="asd")
plot(xlab="asd")
plot(c(),c(),xlab="asd")
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
risk_red_sim
ns
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
ri
colors[ri]
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
colors[ri]
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
as.expression(bquote('r'^'2'*'='*.( r2))))
as.expression(bquote('r'^'2'*'='*.( r2)))
legs[1] = as.expression(bquote('r'^'2'*'='*.( r2)))
legs = numeric(3)
legs[1] = as.expression(bquote('r'^'2'*'='*.( r2)))
legs
legs = numeric(length(r2s))
for (ri in seq_along(r2s))
{
legs[ri] = as.expression(bquote('K='*.(K)*', r'^'2'*'='*.(r2)))
}
legend('bottomright',legs,col=colors,pch=0:2,bty='n',cex=1.3,text.col='DarkBlue')
legs = numeric(length(r2s))
for (ri in seq_along(r2s))
{
r2 = r2s[ri]
legs[ri] = as.expression(bquote('K='*.(K)*', r'^'2'*'='*.(r2)))
}
legend('bottomright',legs,col=colors,pch=0:2,bty='n',cex=1.3,text.col='DarkBlue')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
plot.new()
source('D:/Work/Projects/Prediction/Code/embryo_selection/GenerateFigures.R')
risk_red_sim
